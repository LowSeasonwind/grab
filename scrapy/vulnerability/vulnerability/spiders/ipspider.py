#coding=utf-8
import sys
from scrapy.spiders import CrawlSpider
from scrapy.selector import Selector
if sys.getdefaultencoding() != 'utf-8':
    reload(sys)
    sys.setdefaultencoding('utf-8')

class ip(CrawlSpider):

    name = 'ips'
    start_urls = ['http://www.xicidaili.com/']


    def parse(self, response):
        sel = Selector(response)
        links = sel.xpath('//table[@id="ip_list"]/tr[@class="odd" or @class=""]')
        for link in links:
            values = link.xpath("td/text()").extract()
            ip = values[0].strip() + ':' + values[1].strip()
            with open('/opt/2.txt', 'a+') as f:
                f.writelines(ip + '\n')